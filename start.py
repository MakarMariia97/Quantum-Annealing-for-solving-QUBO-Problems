#!/usr/bin/env python3

from QA4QUBO import matrix, vector, solver
from os import listdir
from os.path import isfile, join
import sys
import numpy as np
qap = [f for f in listdir("QA4QUBO/tests/") if isfile(join("QA4QUBO/tests/", f))]
MAX = 1000

np.set_printoptions(threshold=sys.maxsize)

def getproblem():
    elements = list()
    i = 0
    for element in qap:
        elements.append(element)
        element = element[:-4]
        print(f"Write {i} for the problem {element}")
        i += 1
    
    problem = int(input("Which problem do you want to select? "))
    DIR = "QA4QUBO/tests/"+qap[problem]
    return DIR, qap[problem]

def write(dir, string):
    file = open(dir, 'a')
    file.write(string+'\n')
    file.close()

def generate_file_npp(_n:int):
    nok = True
    i = 0
    max_range = MAX
    dir = "output_"+str(_n)+"_"+ str(max_range)
    while(nok):
        try:
            with open("output/"+dir+".txt", "r") as file:
                pass
            max_range = int(max_range/2)
            if(not max_range):
                exit("File output terminati")
            dir = "output_"+str(_n)+"_"+ str(max_range)
            i += 1
        except IOError:
            nok = False
        
    DIR = "output/"+dir+".txt"
    open(DIR, 'a').close()

    return DIR, max_range

def file_qap(name):
    nok = True
    i = 0
    dir = "output_"+str(name)+"_"+ str(i)
    while(nok):
        try:
            with open("output/"+dir+".txt", "r") as file:
                pass
            i += 1
            dir = "output_"+str(name)+"_"+ str(i)
        except IOError:
            nok = False
        
    DIR = "output/"+dir+".txt"
    open(DIR, 'a').close()

    return DIR

def main(_n):    
    
    #QAP = input("Do you want to use a QAP problem? (y/n) ")
    QAP = True
    if(QAP in ['y', 'Y', 1, 's', 'S']):
        QAP = True
        _dir, name = getproblem()
        _Q, penalty, _n, y = matrix.generate_QAP_problem(_dir)
        #with open(_dir) as file:
        #    _Q, _n = matrix.generate_QAP_problem(file)
        name = name.replace(".txt","")
        _DIR = file_qap(name)

    else:
        QAP = False
        if _n == 0:
            _n = int(input("Insert n: "))
        _DIR, max_range = generate_file_npp(_n)
        S = vector.generate_S(_n, max_range)
        #500
        #S = [357, 0, 881, 284, 385, 662, 986, 666, 973, 887, 249, 919, 268, 623, 999, 386, 201, 9, 170, 767, 40, 450, 96, 216, 474, 649, 817, 509, 84, 159, 908, 761, 499, 119, 724, 951, 520, 973, 78, 238, 469, 995, 596, 382, 538, 937, 296, 984, 479, 452, 484, 119, 816, 301, 323, 684, 595, 406, 875, 872, 312, 970, 337, 459, 860, 387, 731, 885, 233, 488, 626, 539, 298, 595, 740, 392, 100, 670, 227, 523, 48, 534, 389, 608, 435, 969, 843, 387, 638, 597, 540, 173, 119, 800, 858, 849, 122, 738, 416, 941, 750, 224, 388, 699, 325, 893, 578, 214, 726, 258, 789, 31, 32, 473, 173, 719, 641, 623, 442, 198, 963, 787, 908, 184, 237, 190, 538, 15, 736, 874, 23, 717, 881, 632, 956, 508, 956, 729, 790, 261, 836, 82, 37, 354, 420, 970, 950, 326, 173, 571, 718, 923, 737, 286, 312, 596, 538, 790, 979, 878, 841, 395, 979, 25, 179, 778, 825, 169, 922, 200, 689, 952, 541, 383, 860, 643, 554, 524, 192, 112, 686, 619, 10, 571, 1000, 80, 74, 622, 742, 622, 387, 941, 715, 555, 32, 117, 94, 41, 298, 951, 577, 617, 917, 937, 298, 59, 553, 718, 41, 827, 805, 339, 275, 41, 363, 555, 421, 200, 802, 866, 769, 513, 49, 228, 280, 997, 747, 578, 298, 461, 469, 830, 877, 335, 370, 468, 953, 466, 280, 808, 736, 211, 637, 882, 59, 684, 357, 420, 353, 160, 598, 290, 66, 15, 446, 19, 483, 379, 747, 996, 238, 363, 455, 215, 6, 716, 751, 398, 493, 564, 563, 216, 479, 926, 257, 650, 227, 808, 182, 77, 388, 916, 963, 126, 182, 41, 919, 229, 507, 503, 860, 763, 683, 326, 310, 582, 698, 493, 727, 442, 977, 19, 280, 495, 20, 181, 952, 411, 999, 590, 170, 475, 185, 868, 110, 951, 276, 129, 876, 458, 917, 410, 11, 568, 906, 791, 970, 608, 613, 937, 303, 628, 460, 97, 923, 857, 991, 775, 673, 386, 993, 625, 247, 312, 877, 61, 444, 263, 420, 784, 725, 83, 383, 257, 118, 600, 7, 485, 558, 46, 680, 273, 880, 278, 736, 170, 330, 270, 461, 722, 166, 627, 325, 261, 946, 227, 306, 290, 395, 450, 91, 378, 102, 447, 705, 652, 728, 231, 510, 199, 836, 633, 478, 236, 118, 191, 820, 339, 615, 891, 952, 473, 793, 825, 123, 442, 83, 313, 162, 942, 289, 971, 205, 844, 134, 3, 767, 78, 166, 898, 22, 311, 806, 368, 41, 430, 389, 824, 720, 989, 664, 164, 370, 284, 735, 978, 368, 225, 662, 920, 204, 462, 478, 759, 564, 643, 139, 332, 334, 784, 622, 831, 47, 718, 743, 411, 779, 713, 891, 935, 814, 244, 739, 549, 793, 821, 312, 183, 560, 67, 328, 204, 674, 55, 590, 899, 244, 864, 371, 672, 234, 314, 727, 388, 715, 371, 605, 390, 482, 395, 36, 864, 923, 872, 145, 239, 832, 167, 474, 553]
        #1000
        #S = [557, 529, 741, 376, 219, 826, 522, 425, 521, 807, 556, 437, 423, 547, 318, 860, 546, 938, 426, 370, 874, 936, 807, 442, 407, 125, 175, 633, 916, 349, 387, 525, 558, 455, 114, 531, 191, 770, 77, 872, 75, 646, 32, 373, 338, 210, 341, 602, 216, 559, 654, 631, 736, 716, 567, 300, 751, 138, 160, 941, 94, 171, 142, 629, 734, 427, 67, 152, 213, 935, 736, 71, 647, 911, 441, 704, 311, 842, 602, 420, 465, 417, 205, 150, 475, 858, 16, 819, 37, 173, 59, 405, 229, 538, 174, 614, 525, 444, 745, 791, 314, 164, 421, 660, 214, 291, 597, 630, 82, 140, 397, 373, 593, 930, 348, 895, 221, 261, 113, 668, 742, 408, 908, 416, 581, 469, 359, 969, 401, 618, 292, 814, 948, 827, 846, 701, 258, 582, 893, 543, 514, 277, 676, 695, 608, 413, 134, 767, 407, 336, 128, 549, 490, 7, 28, 831, 996, 972, 36, 510, 360, 699, 572, 304, 643, 55, 570, 584, 966, 787, 113, 652, 987, 51, 760, 106, 227, 689, 875, 74, 552, 503, 381, 16, 149, 53, 773, 962, 813, 948, 647, 42, 183, 106, 260, 543, 744, 195, 958, 667, 699, 683, 290, 918, 137, 135, 296, 130, 311, 243, 717, 839, 792, 838, 318, 369, 547, 850, 10, 552, 514, 454, 407, 184, 644, 776, 181, 408, 591, 610, 936, 260, 320, 392, 765, 333, 993, 803, 409, 595, 89, 562, 51, 235, 672, 507, 247, 767, 145, 996, 407, 926, 362, 772, 405, 245, 103, 626, 648, 925, 495, 889, 842, 153, 512, 595, 817, 257, 945, 106, 391, 159, 595, 11, 735, 614, 727, 704, 726, 192, 560, 319, 258, 677, 8, 104, 640, 864, 950, 250, 586, 972, 477, 4, 746, 123, 945, 893, 144, 19, 433, 691, 1, 65, 266, 676, 885, 832, 653, 330, 664, 136, 628, 182, 342, 394, 981, 288, 238, 508, 426, 620, 72, 501, 50, 693, 955, 788, 282, 951, 188, 399, 240, 159, 33, 137, 591, 971, 771, 254, 264, 830, 434, 216, 701, 290, 297, 365, 85, 882, 825, 352, 25, 815, 123, 595, 892, 656, 169, 701, 977, 71, 592, 820, 994, 3, 283, 739, 662, 703, 501, 188, 518, 400, 419, 757, 930, 641, 793, 59, 786, 915, 193, 630, 773, 912, 297, 154, 936, 646, 369, 59, 809, 385, 402, 676, 45, 650, 859, 315, 101, 411, 257, 412, 42, 150, 549, 647, 404, 430, 479, 141, 482, 333, 8, 86, 643, 897, 392, 311, 409, 623, 854, 140, 419, 372, 679, 944, 728, 487, 534, 977, 233, 733, 348, 426, 892, 261, 122, 914, 758, 911, 900, 129, 453, 966, 568, 375, 865, 220, 928, 393, 37, 709, 689, 487, 584, 999, 279, 925, 568, 99, 815, 291, 249, 713, 419, 756, 499, 639, 352, 338, 653, 129, 864, 323, 808, 87, 562, 215, 824, 155, 947, 221, 476, 332, 565, 842, 244, 179, 540, 128, 206, 955, 142, 844, 507, 331, 954, 379, 375, 309, 136, 20, 54, 111, 323, 320, 445, 441, 942, 739, 407, 413, 407, 867, 644, 773, 742, 963, 820, 265, 193, 368, 278, 964, 840, 70, 484, 207, 186, 997, 236, 312, 454, 412, 817, 389, 250, 844, 806, 815, 413, 649, 492, 719, 167, 432, 86, 369, 967, 350, 856, 421, 430, 251, 890, 369, 721, 913, 218, 597, 466, 80, 730, 680, 487, 525, 106, 362, 733, 121, 332, 49, 402, 300, 146, 492, 632, 817, 534, 573, 236, 204, 438, 714, 586, 211, 48, 713, 772, 919, 817, 521, 506, 381, 922, 745, 570, 368, 693, 394, 183, 81, 93, 726, 564, 821, 778, 203, 789, 696, 896, 54, 952, 362, 723, 613, 685, 646, 255, 595, 152, 848, 195, 785, 457, 155, 323, 460, 706, 148, 530, 276, 244, 155, 442, 274, 858, 518, 662, 89, 145, 118, 692, 472, 359, 119, 910, 456, 347, 965, 202, 7, 64, 654, 121, 258, 327, 9, 230, 19, 904, 102, 482, 965, 106, 339, 435, 682, 920, 226, 597, 550, 867, 247, 593, 652, 602, 584, 588, 791, 147, 557, 20, 908, 905, 845, 614, 839, 343, 454, 574, 913, 249, 100, 731, 911, 105, 440, 207, 565, 476, 256, 514, 899, 876, 684, 434, 576, 212, 935, 431, 966, 557, 242, 635, 12, 546, 964, 443, 606, 509, 702, 293, 278, 66, 237, 875, 908, 187, 241, 746, 785, 422, 270, 275, 759, 49, 237, 602, 593, 532, 928, 26, 80, 411, 661, 59, 943, 744, 935, 445, 243, 990, 208, 757, 471, 148, 293, 40, 259, 659, 586, 307, 201, 817, 87, 226, 539, 927, 88, 688, 444, 861, 90, 869, 117, 428, 988, 276, 476, 798, 293, 552, 313, 951, 431, 816, 969, 699, 561, 220, 753, 342, 997, 468, 622, 980, 91, 336, 497, 236, 418, 337, 724, 331, 290, 32, 955, 155, 312, 104, 991, 885, 44, 326, 704, 327, 905, 802, 59, 412, 816, 643, 424, 836, 106, 709, 549, 669, 429, 18, 534, 532, 701, 500, 705, 515, 308, 252, 864, 6, 587, 971, 507, 244, 151, 676, 759, 434, 482, 506, 592, 538, 90, 903, 348, 560, 668, 103, 62, 385, 316, 340, 513, 970, 773, 81, 340, 483, 35, 961, 742, 148, 868, 880, 668, 929, 162, 507, 887, 174, 391, 916, 345, 789, 811, 694, 595, 884, 466, 796, 208, 739, 804, 670, 156, 172, 963, 536, 177, 267, 87, 859, 47, 332, 709, 627, 932, 888, 339, 476, 15, 933, 270, 263, 246, 311, 326, 641, 480, 730, 834, 884, 762, 89, 697, 525, 577, 118, 711, 12, 397, 218, 281, 218, 650, 765, 469, 197, 767, 951, 58, 677, 881, 316, 530, 785, 102, 256, 723, 273, 742, 419, 665, 10, 556, 175, 865, 635, 427, 661, 694, 71, 257, 110, 295, 458, 903, 811, 991, 172, 822, 749, 471, 738, 263, 693, 548, 283, 786, 686, 879, 634, 106, 356, 303, 741, 208, 513, 896, 260, 312, 454, 214, 482, 931, 226, 247]
        #2500
        #S = [635, 832, 421, 966, 400, 320, 893, 305, 17, 266, 72, 798, 322, 433, 626, 162, 59, 682, 661, 5, 495, 853, 787, 766, 894, 601, 613, 485, 140, 745, 855, 661, 569, 870, 874, 880, 976, 356, 222, 373, 213, 845, 253, 766, 367, 565, 777, 246, 294, 144, 472, 228, 849, 930, 779, 639, 238, 485, 691, 501, 569, 5, 574, 792, 338, 169, 406, 793, 537, 148, 540, 399, 847, 416, 637, 833, 40, 336, 784, 247, 640, 605, 458, 298, 793, 414, 865, 861, 489, 642, 459, 464, 642, 414, 588, 856, 566, 703, 657, 223, 373, 379, 69, 278, 149, 59, 144, 37, 955, 155, 231, 132, 600, 318, 164, 539, 87, 403, 550, 989, 268, 686, 209, 337, 966, 796, 983, 929, 590, 157, 188, 6, 761, 625, 413, 678, 909, 560, 955, 81, 284, 57, 452, 15, 457, 160, 185, 446, 387, 951, 838, 705, 80, 816, 573, 555, 551, 993, 561, 367, 367, 780, 901, 752, 662, 493, 225, 667, 103, 336, 431, 744, 46, 707, 914, 112, 333, 54, 372, 648, 33, 897, 631, 434, 119, 738, 447, 897, 556, 455, 293, 125, 712, 321, 88, 271, 658, 939, 753, 123, 810, 821, 275, 719, 31, 836, 469, 25, 773, 414, 234, 384, 938, 544, 248, 619, 765, 130, 622, 472, 4, 554, 577, 574, 150, 605, 189, 837, 973, 85, 743, 718, 702, 345, 656, 819, 595, 590, 585, 254, 363, 547, 668, 456, 674, 243, 970, 218, 124, 354, 669, 386, 588, 841, 778, 630, 486, 802, 397, 237, 849, 298, 6, 518, 270, 880, 473, 647, 295, 924, 63, 297, 228, 719, 82, 997, 320, 9, 157, 520, 84, 309, 570, 82, 237, 689, 673, 370, 52, 446, 290, 399, 497, 885, 635, 403, 116, 472, 575, 787, 568, 795, 535, 505, 376, 746, 143, 432, 161, 255, 901, 709, 465, 376, 535, 322, 249, 399, 702, 160, 508, 346, 347, 748, 103, 471, 152, 562, 49, 97, 288, 494, 525, 401, 69, 922, 700, 184, 441, 74, 568, 896, 706, 318, 256, 419, 447, 487, 716, 997, 639, 842, 342, 44, 498, 21, 391, 839, 922, 163, 232, 366, 771, 625, 435, 377, 376, 807, 825, 565, 193, 943, 1, 958, 650, 560, 38, 318, 506, 970, 15, 41, 396, 557, 831, 426, 873, 288, 61, 737, 245, 436, 215, 434, 324, 10, 1000, 801, 550, 29, 423, 170, 511, 879, 55, 794, 545, 568, 12, 346, 465, 833, 383, 66, 536, 766, 512, 506, 588, 801, 571, 274, 133, 0, 641, 502, 106, 717, 50, 739, 164, 603, 28, 661, 646, 851, 708, 212, 35, 290, 745, 632, 41, 906, 797, 785, 629, 848, 844, 852, 784, 232, 992, 559, 105, 621, 556, 224, 254, 870, 533, 406, 793, 495, 991, 944, 436, 248, 993, 651, 261, 337, 261, 610, 922, 88, 425, 177, 468, 913, 404, 553, 151, 267, 142, 867, 392, 531, 869, 532, 869, 72, 941, 888, 249, 542, 351, 64, 707, 59, 600, 851, 476, 241, 586, 909, 661, 400, 240, 837, 417, 308, 284, 745, 274, 194, 11, 557, 987, 89, 359, 739, 431, 678, 563, 484, 220, 168, 110, 207, 789, 303, 813, 24, 159, 448, 187, 336, 713, 812, 684, 140, 724, 194, 332, 149, 114, 798, 730, 773, 414, 443, 167, 67, 595, 670, 506, 149, 673, 417, 265, 896, 600, 660, 51, 475, 383, 553, 331, 739, 159, 800, 592, 144, 525, 634, 106, 585, 267, 248, 521, 820, 826, 808, 931, 492, 143, 325, 966, 890, 524, 693, 489, 639, 73, 519, 691, 794, 554, 403, 203, 665, 576, 0, 472, 117, 193, 724, 757, 726, 388, 611, 789, 320, 778, 889, 895, 677, 449, 187, 343, 159, 546, 697, 67, 393, 409, 928, 362, 43, 553, 114, 875, 907, 503, 542, 861, 146, 634, 478, 863, 967, 912, 836, 698, 482, 88, 959, 606, 306, 594, 721, 291, 61, 916, 848, 948, 824, 381, 412, 562, 990, 70, 120, 69, 469, 12, 6, 831, 500, 227, 58, 162, 145, 806, 198, 12, 612, 987, 123, 331, 670, 324, 212, 948, 272, 378, 245, 472, 183, 859, 232, 653, 556, 825, 533, 715, 660, 632, 342, 23, 3, 458, 667, 831, 200, 327, 437, 244, 362, 343, 803, 310, 332, 411, 207, 88, 119, 48, 31, 630, 928, 763, 427, 189, 315, 644, 902, 734, 312, 184, 176, 380, 149, 709, 589, 427, 67, 867, 422, 158, 761, 230, 909, 183, 259, 512, 511, 905, 557, 613, 532, 272, 634, 600, 669, 471, 27, 837, 498, 927, 682, 496, 375, 857, 69, 75, 883, 552, 973, 524, 207, 391, 574, 444, 293, 67, 113, 223, 573, 993, 71, 211, 98, 846, 650, 380, 158, 918, 240, 708, 122, 433, 893, 148, 772, 360, 679, 430, 352, 670, 960, 695, 884, 188, 945, 665, 163, 657, 838, 274, 803, 759, 42, 159, 420, 931, 371, 866, 154, 555, 907, 102, 526, 659, 981, 651, 334, 549, 797, 161, 918, 68, 212, 861, 868, 384, 695, 785, 105, 859, 598, 315, 745, 125, 364, 417, 621, 39, 624, 367, 736, 437, 292, 429, 857, 777, 808, 247, 967, 382, 431, 319, 468, 579, 455, 30, 491, 850, 442, 665, 355, 603, 438, 401, 281, 733, 413, 184, 967, 289, 585, 766, 370, 831, 554, 1, 853, 498, 931, 380, 706, 699, 213, 635, 955, 716, 606, 925, 237, 192, 220, 645, 335, 133, 656, 142, 994, 265, 187, 813, 457, 148, 407, 538, 73, 820, 171, 64, 909, 992, 332, 266, 674, 333, 36, 744, 510, 586, 484, 878, 322, 239, 816, 878, 529, 208, 925, 351, 225, 552, 498, 308, 753, 938, 468, 832, 434, 697, 586, 124, 122, 594, 972, 913, 193, 677, 533, 922, 767, 270, 705, 976, 697, 486, 730, 957, 65, 342, 510, 59, 742, 267, 749, 206, 468, 122, 950, 299, 951, 907, 984, 710, 466, 34, 737, 243, 489, 951, 611, 169, 655, 943, 670, 954, 480, 919, 667, 147, 378, 953, 415, 753, 288, 741, 875, 522, 538, 583, 583, 421, 754, 533, 619, 433, 158, 384, 448, 568, 389, 383, 104, 838, 585, 35, 516, 466, 424, 818, 578, 982, 165, 75, 309, 501, 575, 192, 865, 709, 884, 907, 132, 472, 385, 369, 890, 989, 852, 503, 76, 847, 492, 84, 565, 987, 973, 150, 76, 389, 76, 414, 720, 404, 505, 390, 948, 973, 255, 934, 996, 623, 365, 174, 404, 940, 960, 474, 234, 655, 263, 997, 6, 581, 430, 813, 832, 902, 607, 368, 372, 433, 220, 341, 171, 816, 856, 229, 607, 595, 28, 913, 770, 513, 150, 320, 55, 23, 77, 853, 601, 894, 998, 500, 774, 473, 430, 393, 773, 432, 181, 747, 196, 380, 684, 518, 494, 525, 481, 391, 198, 404, 775, 531, 377, 250, 578, 691, 589, 825, 411, 728, 428, 679, 783, 98, 264, 381, 61, 300, 363, 717, 616, 68, 992, 326, 894, 741, 66, 514, 167, 21, 605, 205, 436, 811, 920, 994, 960, 428, 367, 605, 714, 866, 355, 483, 105, 387, 144, 502, 943, 647, 540, 604, 464, 253, 494, 717, 403, 120, 486, 657, 501, 276, 736, 917, 461, 149, 389, 136, 948, 757, 881, 234, 178, 689, 606, 47, 806, 283, 434, 833, 835, 959, 765, 49, 844, 179, 63, 775, 166, 364, 896, 584, 23, 760, 378, 531, 594, 306, 188, 877, 707, 488, 947, 956, 982, 682, 543, 860, 122, 655, 903, 251, 717, 863, 739, 585, 490, 928, 815, 752, 509, 819, 957, 44, 175, 618, 292, 168, 160, 638, 253, 458, 10, 477, 228, 825, 113, 298, 324, 859, 481, 227, 606, 799, 506, 587, 807, 309, 898, 326, 986, 129, 931, 301, 286, 356, 245, 81, 449, 982, 660, 752, 291, 119, 624, 351, 215, 425, 14, 579, 945, 628, 85, 906, 820, 270, 725, 925, 934, 713, 469, 481, 759, 250, 290, 6, 994, 947, 469, 793, 374, 387, 562, 1, 256, 209, 162, 289, 551, 795, 596, 184, 289, 691, 700, 6, 175, 928, 983, 294, 488, 615, 631, 716, 457, 326, 300, 697, 505, 744, 70, 825, 860, 131, 202, 339, 774, 167, 461, 810, 319, 961, 691, 416, 650, 836, 265, 715, 275, 548, 936, 288, 359, 901, 860, 493, 492, 42, 691, 5, 192, 204, 991, 498, 546, 325, 274, 235, 22, 944, 965, 700, 171, 332, 365, 758, 758, 897, 819, 948, 335, 396, 194, 790, 455, 550, 32, 564, 696, 211, 930, 273, 592, 450, 62, 896, 691, 259, 590, 771, 256, 557, 546, 649, 155, 858, 324, 717, 225, 587, 481, 653, 654, 216, 516, 595, 30, 640, 3, 288, 903, 653, 263, 751, 845, 895, 586, 464, 624, 774, 330, 700, 392, 20, 742, 240, 809, 268, 142, 919, 960, 395, 88, 918, 97, 278, 311, 1000, 949, 781, 520, 508, 508, 961, 529, 795, 623, 84, 497, 587, 887, 819, 709, 430, 67, 86, 31, 248, 159, 583, 676, 671, 333, 556, 537, 771, 376, 810, 529, 10, 494, 163, 207, 752, 620, 240, 902, 652, 462, 985, 695, 59, 916, 528, 911, 510, 189, 379, 210, 799, 900, 548, 594, 938, 16, 839, 665, 499, 350, 398, 732, 560, 2, 27, 297, 555, 346, 845, 901, 341, 117, 845, 777, 561, 590, 657, 466, 458, 494, 784, 797, 35, 936, 868, 219, 754, 729, 627, 919, 676, 750, 597, 62, 680, 48, 850, 175, 556, 743, 410, 52, 669, 179, 413, 258, 563, 171, 89, 523, 415, 510, 994, 417, 798, 79, 764, 221, 779, 919, 372, 363, 754, 128, 310, 513, 969, 723, 292, 744, 966, 575, 897, 70, 828, 354, 853, 899, 59, 987, 679, 993, 910, 45, 655, 724, 321, 408, 926, 232, 85, 803, 178, 663, 18, 145, 33, 771, 980, 546, 833, 279, 942, 740, 26, 490, 813, 808, 998, 207, 750, 739, 37, 898, 826, 649, 413, 668, 343, 995, 737, 687, 215, 853, 696, 872, 934, 903, 416, 14, 837, 377, 478, 33, 722, 438, 642, 75, 357, 115, 455, 341, 139, 455, 612, 235, 819, 182, 467, 221, 265, 297, 510, 167, 643, 981, 140, 731, 91, 393, 302, 419, 961, 390, 257, 841, 856, 173, 166, 476, 734, 569, 561, 550, 351, 603, 354, 726, 828, 696, 549, 131, 851, 995, 369, 728, 256, 183, 432, 680, 18, 272, 796, 636, 272, 304, 605, 547, 165, 674, 353, 268, 834, 835, 431, 400, 582, 826, 978, 88, 260, 473, 98, 230, 324, 415, 910, 335, 104, 224, 951, 983, 20, 911, 741, 567, 447, 621, 438, 153, 820, 592, 508, 434, 167, 543, 267, 781, 880, 758, 572, 277, 431, 634, 103, 595, 347, 169, 744, 374, 975, 582, 54, 782, 68, 185, 797, 173, 740, 246, 441, 243, 215, 671, 609, 464, 571, 208, 824, 690, 466, 528, 503, 400, 261, 726, 599, 671, 502, 576, 139, 691, 267, 244, 218, 472, 434, 301, 341, 168, 930, 156, 955, 740, 52, 602, 369, 577, 844, 606, 646, 16, 430, 387, 964, 935, 779, 651, 771, 117, 544, 541, 955, 733, 631, 772, 708, 969, 932, 636, 76, 713, 68, 456, 867, 310, 815, 775, 356, 494, 813, 44, 472, 661, 308, 721, 118, 599, 423, 314, 214, 312, 644, 218, 172, 212, 73, 279, 623, 565, 511, 103, 108, 710, 243, 941, 316, 947, 37, 517, 964, 402, 544, 679, 530, 517, 48, 406, 808, 672, 704, 198, 851, 293, 959, 337, 533, 482, 26, 356, 768, 466, 975, 440, 396, 221, 193, 272, 608, 790, 399, 318, 247, 568, 467, 307, 532, 493, 200, 966, 613, 218, 983, 946, 726, 626, 863, 418, 559, 149, 659, 910, 897, 269, 448, 223, 170, 15, 95, 69, 934, 401, 821, 294, 81, 479, 680, 382, 498, 877, 50, 543, 132, 540, 52, 482, 120, 479, 854, 970, 271, 149, 802, 3, 949, 160, 985, 157, 331, 279, 616, 868, 734, 338, 989, 232, 709, 905, 184, 945, 952, 831, 821, 496, 63, 171, 685, 167, 46, 951, 6, 4, 587, 189, 236, 101, 808, 193, 772, 472, 933, 120, 656, 856, 378, 249, 362, 504, 575, 827, 51, 406, 651, 69, 919, 990, 888, 746, 751, 871, 454, 149, 660, 563, 955, 462, 582, 974, 335, 353, 463, 493, 982, 415, 806, 249, 749, 351, 658, 897, 198, 295, 477, 979, 183, 691, 349, 258, 609, 589, 47, 593, 230, 468, 406, 412, 134, 152, 403, 696, 713, 474, 669, 870, 765, 772, 704, 221, 420, 22, 872, 71, 850, 690, 61, 614, 348, 530, 327, 450, 670, 794, 343, 290, 461, 235, 503, 689, 582, 809, 536, 53, 852, 428, 769, 471, 766, 778, 135, 909, 909, 876, 603, 143, 236, 631, 679, 752, 208, 504, 626, 752, 431, 707, 657, 30, 96, 297, 155, 103, 780, 328, 721, 16, 692, 45, 190, 734, 369, 200, 29, 676, 889, 355, 173, 836, 231, 633, 823, 580, 697, 684, 714, 585, 823, 399, 52, 548, 439, 43, 716, 19, 268, 583, 532, 364, 912, 288, 242, 88, 884, 102, 697, 552, 628, 29, 233, 164, 913, 464, 248, 942, 716, 799, 364, 931, 328, 684, 345, 917, 454, 2, 597, 703, 560, 805, 889, 953, 716, 217, 321, 719, 103, 286, 479, 875, 159, 80, 859, 65, 925, 680, 650, 519, 543, 959, 75, 198, 228, 727, 346, 637, 96, 471, 231, 753, 1000, 846, 308, 732, 56, 456, 805, 307, 563, 191, 669, 106, 241, 142, 146, 127, 77, 365, 910, 674, 155, 802, 328, 642, 772, 296, 442, 138, 361, 140, 537, 950, 694, 362, 705, 706, 739, 713, 270, 151, 156, 284, 712, 297, 986, 375, 328, 98, 34, 512, 704, 375, 644, 850, 652, 511, 749, 571, 972, 482, 275, 231, 532, 502, 180, 52, 662, 270, 86, 582, 58, 89, 240, 221, 784, 540, 654, 994, 847, 300, 143, 816, 28, 510, 297, 429, 482, 224, 486, 929, 469, 16, 141, 335, 623, 692, 267, 522, 441, 691, 763, 56, 48, 800, 402, 247, 611, 680, 152, 51, 948, 756, 832, 31, 708, 935, 128, 14, 974, 535, 206, 444, 978, 31, 748, 217, 279, 626, 805, 810, 134, 129, 727, 309, 928, 510, 74, 980, 268, 902, 821, 682, 561, 907, 388, 705, 467, 620, 200, 431, 416, 895, 976, 982, 938, 671, 277, 884, 725, 198, 864, 513, 439, 300, 994, 445, 666, 671, 270, 941, 671, 576, 717, 90, 677, 140, 109, 908, 150, 573, 595, 700, 628, 107, 627, 276, 464, 252, 895, 5, 357, 228, 302, 384, 887, 631, 946, 160, 22, 149, 459, 743, 724, 487, 142, 185, 397, 221, 21, 317, 389, 117, 89, 527, 183, 564, 335, 425, 777, 100, 962, 793, 448, 81, 406, 454, 782, 722, 583, 122, 605, 891, 3, 428, 529, 505, 828, 878, 891, 386, 904, 261, 239, 259, 962, 772, 840, 6, 819, 17, 708, 403, 696, 869, 654, 939, 142, 252, 104, 959, 490, 724, 398, 537, 791, 736, 54, 488, 20, 913, 562, 317, 771, 657]
        #5000
        #S = [334, 780, 724, 857, 45, 855, 171, 124, 95, 755, 850, 265, 991, 62, 263, 118, 559, 118, 368, 561, 256, 355, 759, 636, 52, 537, 570, 456, 151, 620, 631, 989, 447, 180, 986, 741, 219, 64, 845, 805, 192, 166, 70, 26, 686, 170, 272, 171, 615, 49, 875, 317, 982, 426, 948, 843, 952, 120, 971, 275, 321, 300, 28, 908, 829, 940, 938, 536, 73, 967, 201, 388, 528, 56, 712, 952, 154, 230, 221, 201, 504, 313, 824, 292, 495, 465, 683, 314, 525, 883, 303, 861, 242, 639, 343, 345, 35, 277, 878, 590, 847, 725, 181, 106, 566, 31, 43, 871, 272, 961, 975, 900, 983, 775, 622, 13, 120, 167, 154, 102, 177, 121, 354, 729, 506, 924, 635, 859, 39, 620, 522, 770, 742, 722, 320, 490, 571, 490, 384, 37, 858, 466, 60, 520, 856, 701, 738, 69, 441, 678, 498, 2, 788, 606, 156, 47, 661, 357, 523, 584, 126, 368, 626, 0, 768, 370, 592, 787, 136, 667, 733, 269, 798, 750, 240, 738, 485, 574, 76, 98, 62, 651, 587, 869, 325, 292, 824, 153, 452, 99, 391, 577, 997, 524, 930, 906, 902, 151, 659, 679, 841, 168, 747, 626, 350, 401, 725, 698, 747, 382, 65, 328, 142, 562, 415, 194, 328, 880, 939, 418, 399, 898, 909, 63, 527, 183, 842, 604, 273, 832, 562, 166, 809, 33, 328, 299, 158, 736, 330, 783, 983, 242, 477, 869, 281, 428, 34, 33, 421, 411, 20, 917, 331, 356, 101, 704, 112, 95, 97, 588, 607, 366, 844, 358, 413, 113, 427, 172, 643, 575, 168, 390, 763, 968, 232, 959, 272, 281, 578, 45, 641, 176, 864, 483, 860, 861, 183, 715, 601, 62, 887, 477, 740, 389, 357, 795, 469, 406, 127, 486, 219, 857, 57, 398, 242, 29, 155, 337, 515, 571, 642, 935, 770, 627, 28, 605, 995, 985, 832, 775, 77, 329, 491, 434, 387, 791, 902, 419, 22, 518, 127, 628, 127, 131, 581, 487, 264, 840, 924, 500, 755, 912, 118, 393, 134, 390, 495, 511, 464, 820, 587, 8, 94, 409, 50, 740, 560, 810, 458, 90, 918, 922, 859, 719, 77, 866, 631, 974, 461, 331, 811, 11, 634, 853, 918, 187, 60, 593, 908, 475, 555, 394, 750, 533, 924, 329, 841, 717, 657, 380, 89, 82, 17, 367, 860, 503, 243, 316, 265, 419, 673, 135, 474, 990, 542, 180, 14, 221, 28, 486, 554, 470, 458, 692, 758, 266, 329, 348, 95, 460, 266, 467, 340, 698, 1000, 580, 221, 86, 1000, 127, 545, 233, 395, 800, 876, 883, 160, 303, 622, 986, 737, 766, 7, 461, 107, 703, 971, 410, 252, 397, 97, 544, 786, 266, 291, 472, 924, 777, 387, 568, 318, 60, 26, 64, 267, 635, 108, 495, 749, 973, 875, 560, 238, 40, 381, 946, 410, 717, 225, 998, 951, 472, 954, 25, 646, 617, 289, 302, 341, 716, 671, 552, 113, 463, 430, 829, 868, 24, 990, 403, 733, 371, 618, 961, 281, 888, 24, 182, 205, 838, 966, 296, 0, 957, 434, 93, 252, 990, 381, 776, 49, 480, 444, 720, 796, 726, 553, 87, 14, 750, 869, 728, 932, 361, 149, 582, 900, 17, 915, 168, 795, 103, 379, 697, 287, 882, 943, 382, 901, 208, 138, 493, 768, 296, 71, 748, 347, 264, 138, 687, 201, 834, 996, 629, 373, 558, 776, 739, 810, 220, 250, 432, 637, 172, 172, 127, 479, 537, 976, 25, 863, 142, 969, 233, 825, 85, 443, 83, 838, 53, 765, 563, 243, 118, 469, 522, 910, 167, 482, 289, 410, 959, 437, 359, 589, 567, 350, 622, 405, 850, 477, 600, 500, 231, 117, 988, 263, 771, 142, 652, 31, 197, 958, 251, 217, 826, 905, 403, 427, 18, 208, 347, 74, 285, 1000, 470, 507, 67, 922, 425, 301, 412, 344, 938, 814, 151, 948, 89, 71, 434, 720, 14, 646, 405, 402, 694, 115, 820, 306, 974, 730, 374, 815, 384, 683, 539, 867, 228, 558, 999, 465, 804, 520, 248, 44, 510, 490, 161, 712, 324, 502, 419, 341, 124, 150, 721, 346, 595, 105, 262, 392, 217, 945, 861, 975, 739, 189, 768, 439, 259, 668, 364, 640, 847, 145, 115, 561, 813, 203, 172, 150, 930, 946, 457, 749, 872, 99, 669, 135, 909, 778, 871, 313, 241, 908, 198, 636, 907, 155, 197, 335, 419, 367, 223, 752, 755, 622, 300, 375, 592, 527, 710, 392, 617, 532, 774, 542, 540, 164, 849, 742, 293, 639, 652, 348, 788, 283, 339, 432, 811, 333, 974, 929, 705, 260, 594, 232, 215, 329, 423, 155, 86, 624, 845, 293, 225, 4, 79, 827, 751, 667, 349, 481, 505, 296, 545, 454, 708, 667, 943, 797, 28, 684, 882, 978, 614, 82, 97, 347, 463, 544, 456, 889, 548, 546, 526, 41, 599, 416, 17, 495, 768, 529, 361, 141, 329, 52, 802, 770, 344, 981, 503, 594, 71, 421, 286, 450, 389, 2, 525, 849, 326, 907, 590, 750, 394, 981, 553, 663, 883, 115, 478, 851, 571, 135, 907, 428, 527, 228, 37, 541, 812, 548, 74, 961, 855, 416, 253, 47, 190, 732, 569, 850, 874, 925, 863, 950, 877, 608, 786, 948, 995, 876, 670, 97, 695, 811, 585, 180, 68, 662, 113, 292, 440, 394, 275, 390, 294, 136, 917, 383, 759, 552, 505, 842, 133, 254, 785, 133, 141, 881, 513, 140, 302, 175, 653, 118, 403, 267, 650, 377, 467, 424, 878, 383, 125, 242, 615, 605, 958, 525, 302, 811, 681, 978, 874, 493, 828, 348, 276, 316, 615, 447, 137, 183, 478, 749, 13, 732, 972, 392, 581, 117, 208, 190, 16, 315, 784, 234, 954, 778, 410, 751, 690, 545, 597, 778, 614, 530, 228, 688, 635, 71, 172, 276, 262, 21, 896, 669, 237, 741, 298, 379, 264, 737, 495, 833, 474, 26, 962, 758, 426, 921, 176, 631, 724, 709, 423, 590, 648, 920, 348, 576, 737, 23, 257, 381, 405, 704, 728, 942, 166, 934, 325, 903, 522, 958, 803, 410, 181, 288, 388, 636, 261, 314, 487, 137, 224, 715, 753, 144, 952, 715, 745, 200, 217, 443, 810, 453, 671, 786, 993, 370, 976, 258, 850, 472, 103, 785, 712, 72, 717, 19, 748, 818, 554, 121, 550, 56, 455, 347, 772, 85, 811, 812, 302, 692, 915, 90, 986, 266, 525, 947, 29, 452, 916, 99, 900, 883, 750, 198, 357, 915, 352, 639, 45, 21, 183, 229, 149, 391, 731, 111, 42, 317, 281, 657, 793, 726, 664, 885, 506, 198, 355, 924, 889, 387, 963, 18, 962, 474, 348, 525, 984, 135, 351, 614, 877, 251, 281, 545, 247, 803, 140, 877, 238, 474, 146, 217, 232, 276, 460, 712, 702, 810, 413, 142, 867, 725, 461, 675, 250, 495, 359, 15, 445, 974, 661, 512, 199, 719, 396, 861, 211, 371, 38, 775, 665, 468, 52, 82, 856, 578, 387, 492, 928, 728, 611, 206, 528, 148, 313, 909, 752, 197, 723, 247, 848, 903, 678, 797, 867, 309, 870, 920, 355, 923, 660, 176, 498, 309, 649, 493, 197, 930, 577, 93, 145, 689, 417, 65, 592, 174, 645, 565, 758, 52, 769, 887, 963, 71, 338, 765, 463, 316, 557, 117, 168, 603, 185, 153, 42, 745, 585, 114, 229, 204, 779, 326, 814, 538, 300, 802, 842, 972, 932, 809, 487, 648, 963, 811, 791, 856, 893, 904, 691, 902, 712, 964, 558, 361, 728, 30, 398, 66, 861, 376, 409, 261, 864, 573, 594, 264, 513, 690, 400, 185, 425, 542, 121, 155, 81, 746, 441, 301, 589, 900, 982, 700, 668, 111, 244, 362, 35, 547, 472, 404, 681, 955, 612, 624, 683, 478, 625, 656, 110, 903, 903, 107, 586, 243, 495, 79, 725, 11, 245, 983, 862, 675, 958, 457, 11, 579, 598, 878, 234, 824, 180, 907, 224, 207, 841, 256, 339, 531, 326, 781, 659, 636, 7, 805, 145, 373, 582, 695, 859, 871, 408, 981, 397, 7, 114, 12, 506, 158, 504, 404, 48, 33, 364, 622, 328, 325, 374, 551, 508, 977, 489, 807, 122, 88, 223, 867, 473, 892, 699, 809, 545, 95, 623, 517, 348, 504, 104, 348, 437, 402, 15, 440, 942, 678, 422, 976, 787, 717, 458, 185, 661, 893, 601, 397, 106, 531, 602, 283, 130, 511, 136, 982, 587, 937, 206, 810, 843, 337, 572, 33, 442, 739, 454, 781, 66, 837, 201, 239, 785, 613, 387, 398, 515, 558, 972, 23, 335, 166, 681, 856, 516, 966, 27, 182, 882, 644, 990, 522, 389, 657, 341, 823, 114, 93, 293, 444, 873, 330, 505, 964, 234, 943, 408, 676, 644, 276, 759, 257, 172, 662, 161, 545, 701, 283, 910, 566, 784, 597, 57, 726, 181, 259, 148, 306, 475, 615, 620, 692, 826, 694, 752, 820, 713, 642, 813, 646, 723, 221, 645, 459, 462, 891, 595, 906, 675, 166, 64, 636, 17, 496, 480, 879, 614, 984, 449, 818, 291, 176, 19, 962, 658, 52, 315, 905, 583, 323, 7, 730, 879, 38, 693, 167, 844, 349, 109, 518, 792, 696, 343, 457, 877, 531, 215, 198, 964, 547, 79, 132, 828, 513, 213, 51, 820, 583, 506, 6, 944, 809, 836, 175, 927, 820, 428, 642, 745, 579, 921, 248, 111, 186, 535, 633, 756, 774, 707, 87, 505, 319, 325, 322, 956, 26, 240, 739, 584, 367, 153, 424, 680, 62, 143, 394, 262, 285, 482, 133, 777, 904, 631, 533, 142, 455, 865, 914, 946, 824, 801, 596, 355, 744, 95, 700, 990, 883, 724, 150, 769, 77, 416, 249, 371, 942, 924, 37, 503, 116, 315, 994, 685, 646, 245, 715, 498, 143, 771, 162, 767, 562, 168, 296, 208, 408, 422, 284, 60, 81, 209, 580, 568, 457, 562, 836, 323, 276, 64, 74, 807, 189, 944, 334, 581, 392, 425, 749, 797, 908, 874, 386, 591, 472, 336, 767, 994, 225, 329, 89, 616, 387, 357, 934, 892, 224, 669, 34, 743, 271, 667, 107, 376, 834, 342, 566, 472, 65, 862, 494, 271, 513, 130, 627, 58, 134, 785, 997, 708, 360, 674, 194, 976, 566, 453, 798, 159, 617, 921, 51, 277, 106, 56, 824, 654, 964, 414, 868, 954, 622, 733, 932, 566, 848, 842, 922, 283, 954, 366, 46, 435, 503, 25, 138, 517, 694, 890, 34, 724, 292, 178, 622, 968, 56, 26, 988, 112, 514, 406, 610, 29, 113, 680, 352, 281, 50, 327, 389, 911, 598, 626, 712, 657, 969, 698, 756, 660, 841, 20, 639, 2, 435, 421, 295, 542, 318, 62, 740, 559, 643, 973, 278, 806, 110, 659, 914, 692, 806, 580, 639, 348, 28, 706, 485, 444, 777, 154, 237, 590, 873, 67, 295, 173, 307, 182, 681, 261, 158, 884, 69, 709, 930, 590, 415, 982, 613, 580, 191, 562, 957, 139, 533, 28, 210, 325, 383, 941, 814, 891, 94, 652, 427, 961, 249, 63, 129, 236, 968, 5, 356, 305, 334, 318, 652, 992, 746, 491, 887, 308, 53, 318, 680, 889, 162, 877, 986, 731, 311, 341, 656, 681, 75, 58, 162, 262, 25, 591, 47, 299, 9, 534, 830, 28, 530, 715, 35, 175, 509, 665, 376, 963, 908, 622, 856, 481, 687, 103, 715, 68, 459, 709, 338, 654, 815, 315, 235, 128, 893, 255, 494, 852, 901, 209, 343, 139, 81, 447, 131, 785, 482, 349, 210, 944, 803, 97, 787, 442, 273, 898, 953, 877, 405, 954, 460, 19, 148, 97, 217, 467, 199, 199, 869, 344, 900, 413, 754, 102, 822, 21, 620, 897, 91, 840, 804, 493, 583, 833, 270, 904, 829, 169, 595, 19, 7, 931, 353, 958, 335, 368, 967, 301, 419, 254, 46, 596, 997, 437, 20, 461, 204, 819, 183, 73, 525, 94, 47, 9, 776, 375, 330, 508, 468, 593, 152, 390, 569, 225, 806, 298, 924, 368, 263, 175, 655, 661, 635, 643, 653, 473, 702, 220, 102, 654, 609, 892, 315, 400, 457, 888, 118, 606, 569, 617, 702, 497, 847, 679, 44, 933, 241, 806, 20, 495, 310, 946, 59, 148, 474, 387, 436, 735, 292, 788, 793, 756, 730, 267, 161, 755, 899, 130, 307, 633, 47, 337, 167, 292, 998, 838, 374, 233, 990, 333, 961, 852, 110, 988, 580, 85, 327, 901, 935, 844, 536, 522, 690, 472, 905, 802, 646, 93, 361, 458, 949, 152, 182, 391, 357, 820, 379, 218, 515, 235, 226, 748, 225, 459, 719, 612, 130, 716, 131, 291, 721, 411, 121, 132, 340, 846, 609, 787, 656, 234, 493, 106, 601, 812, 776, 579, 27, 586, 455, 7, 266, 135, 348, 333, 396, 851, 718, 157, 642, 681, 361, 865, 142, 311, 590, 287, 220, 962, 102, 438, 129, 825, 421, 745, 521, 460, 906, 545, 875, 249, 633, 843, 168, 220, 621, 794, 130, 159, 681, 815, 986, 906, 970, 134, 372, 395, 853, 776, 788, 670, 350, 912, 808, 806, 725, 109, 304, 646, 97, 713, 261, 93, 269, 839, 762, 155, 810, 30, 527, 74, 337, 949, 96, 686, 426, 907, 250, 898, 419, 737, 26, 679, 287, 889, 97, 432, 509, 963, 526, 29, 523, 857, 863, 447, 690, 201, 958, 231, 120, 458, 709, 877, 402, 299, 468, 504, 351, 908, 875, 926, 132, 112, 119, 968, 32, 958, 768, 367, 851, 65, 939, 38, 826, 365, 181, 622, 837, 14, 644, 179, 893, 1, 887, 727, 663, 495, 948, 8, 473, 620, 863, 188, 149, 946, 504, 911, 862, 577, 967, 22, 823, 508, 772, 531, 388, 55, 965, 530, 268, 692, 75, 968, 410, 352, 385, 375, 503, 298, 28, 673, 1000, 711, 983, 782, 789, 625, 234, 89, 902, 399, 74, 845, 666, 450, 509, 257, 830, 654, 504, 727, 927, 889, 114, 599, 29, 936, 257, 368, 891, 648, 729, 494, 231, 716, 355, 81, 248, 662, 421, 687, 752, 296, 884, 827, 983, 22, 392, 5, 867, 524, 68, 684, 5, 751, 91, 800, 299, 160, 540, 610, 859, 388, 728, 947, 796, 33, 675, 54, 815, 854, 378, 558, 888, 899, 384, 286, 813, 277, 91, 816, 495, 720, 186, 112, 491, 379, 618, 307, 454, 287, 941, 320, 919, 276, 12, 771, 722, 546, 646, 122, 887, 419, 976, 253, 742, 367, 24, 781, 873, 460, 370, 336, 800, 657, 396, 461, 605, 435, 624, 958, 482, 126, 418, 753, 987, 234, 112, 846, 859, 667, 592, 308, 73, 769, 463, 102, 717, 338, 103, 180, 868, 44, 433, 546, 339, 482, 78, 921, 281, 247, 665, 263, 623, 959, 299, 169, 514, 865, 656, 170, 695, 362, 805, 765, 727, 112, 719, 52, 197, 863, 820, 716, 143, 561, 480, 350, 793, 60, 291, 456, 452, 225, 887, 104, 889, 878, 474, 657, 778, 447, 167, 402, 870, 567, 211, 512, 469, 538, 256, 347, 546, 796, 829, 82, 783, 496, 601, 136, 405, 350, 621, 222, 611, 560, 407, 943, 130, 359, 620, 172, 82, 300, 790, 540, 277, 688, 123, 943, 524, 63, 170, 761, 510, 850, 840, 631, 911, 466, 418, 738, 1000, 356, 198, 509, 193, 512, 299, 554, 151, 584, 718, 387, 670, 990, 996, 913, 846, 733, 781, 691, 641, 963, 607, 318, 880, 484, 908, 262, 165, 0, 163, 760, 787, 263, 538, 371, 438, 318, 620, 162, 948, 205, 599, 82, 179, 225, 514, 126, 451, 575, 675, 272, 527, 568, 924, 994, 400, 752, 620, 492, 557, 106, 901, 102, 8, 116, 563, 771, 915, 430, 803, 71, 254, 370, 799, 915, 191, 871, 897, 355, 20, 372, 104, 948, 860, 259, 142, 510, 646, 361, 249, 917, 733, 743, 182, 709, 943, 355, 152, 810, 463, 638, 329, 383, 549, 56, 88, 815, 611, 447, 966, 533, 197, 651, 321, 333, 936, 179, 581, 485, 220, 722, 839, 840, 835, 691, 847, 716, 531, 487, 293, 633, 900, 851, 539, 352, 784, 540, 435, 744, 226, 41, 315, 86, 92, 355, 344, 748, 549, 69, 441, 859, 702, 445, 481, 185, 758, 564, 971, 154, 288, 839, 981, 625, 255, 977, 381, 632, 497, 689, 472, 11, 65, 52, 632, 840, 983, 417, 244, 365, 184, 945, 882, 650, 449, 20, 722, 459, 313, 944, 275, 143, 319, 393, 146, 553, 792, 133, 615, 937, 105, 928, 271, 288, 608, 279, 701, 842, 812, 692, 584, 224, 243, 367, 547, 942, 8, 622, 606, 306, 302, 495, 685, 929, 517, 118, 58, 643, 81, 989, 116, 996, 922, 70, 619, 661, 259, 624, 916, 428, 52, 744, 666, 681, 461, 601, 304, 803, 356, 176, 392, 167, 796, 793, 165, 612, 973, 797, 342, 532, 374, 443, 2, 376, 274, 777, 734, 502, 635, 765, 252, 490, 340, 154, 627, 219, 517, 321, 384, 357, 792, 540, 935, 906, 873, 214, 459, 588, 546, 435, 239, 953, 164, 471, 619, 218, 135, 167, 644, 566, 721, 57, 325, 256, 316, 772, 463, 620, 789, 8, 815, 451, 113, 346, 417, 369, 389, 850, 769, 831, 513, 438, 238, 629, 962, 670, 73, 722, 87, 90, 188, 992, 161, 791, 791, 288, 128, 322, 819, 994, 709, 445, 274, 46, 860, 732, 778, 713, 912, 683, 842, 36, 736, 92, 543, 150, 670, 909, 227, 357, 938, 413, 362, 897, 489, 432, 898, 658, 286, 558, 272, 732, 780, 604, 801, 865, 670, 277, 827, 625, 538, 305, 72, 586, 615, 957, 690, 779, 391, 599, 153, 932, 663, 800, 298, 841, 972, 568, 24, 729, 249, 377, 559, 372, 878, 230, 225, 729, 914, 95, 965, 905, 337, 582, 40, 324, 766, 496, 996, 58, 598, 486, 662, 624, 941, 117, 986, 221, 475, 472, 688, 448, 35, 880, 507, 354, 547, 81, 679, 163, 965, 440, 976, 1, 321, 789, 59, 589, 108, 322, 841, 994, 770, 447, 676, 280, 537, 8, 977, 592, 571, 764, 547, 271, 485, 604, 161, 99, 491, 681, 70, 981, 291, 362, 260, 218, 131, 955, 100, 41, 922, 981, 284, 25, 660, 285, 868, 11, 146, 875, 610, 426, 794, 369, 439, 90, 355, 205, 576, 543, 148, 317, 243, 331, 928, 318, 979, 893, 35, 230, 84, 150, 99, 521, 545, 884, 240, 165, 441, 339, 2, 721, 634, 943, 926, 742, 178, 706, 780, 293, 471, 202, 290, 369, 28, 480, 184, 610, 563, 458, 579, 353, 278, 669, 71, 59, 314, 306, 522, 999, 959, 373, 539, 421, 129, 133, 713, 298, 83, 63, 533, 955, 344, 533, 220, 314, 259, 673, 444, 588, 858, 758, 604, 232, 750, 410, 759, 717, 539, 929, 955, 886, 671, 283, 36, 216, 696, 27, 304, 251, 438, 436, 339, 504, 625, 431, 590, 818, 984, 454, 230, 821, 811, 557, 334, 201, 685, 825, 366, 17, 35, 433, 839, 338, 713, 983, 581, 925, 43, 707, 962, 420, 472, 426, 478, 936, 749, 320, 471, 905, 2, 507, 204, 750, 824, 254, 426, 915, 864, 88, 924, 887, 689, 945, 382, 35, 434, 811, 899, 533, 475, 99, 390, 746, 164, 634, 61, 988, 241, 386, 78, 983, 420, 750, 141, 345, 307, 389, 898, 386, 572, 736, 55, 753, 663, 747, 913, 29, 670, 496, 173, 789, 122, 515, 785, 925, 634, 730, 185, 38, 977, 51, 948, 258, 206, 445, 34, 788, 863, 734, 751, 520, 422, 45, 427, 313, 770, 289, 886, 656, 139, 570, 105, 515, 46, 151, 305, 306, 527, 42, 347, 937, 539, 635, 552, 189, 36, 486, 95, 490, 154, 736, 568, 439, 52, 354, 880, 347, 912, 323, 425, 48, 63, 393, 6, 992, 800, 966, 74, 695, 425, 249, 903, 286, 456, 751, 188, 822, 295, 847, 160, 946, 962, 110, 252, 870, 484, 812, 610, 413, 276, 111, 415, 868, 401, 554, 441, 326, 358, 320, 375, 190, 627, 824, 431, 109, 79, 2, 7, 830, 180, 621, 890, 811, 430, 161, 539, 617, 118, 934, 20, 334, 991, 639, 212, 426, 796, 532, 505, 38, 139, 12, 631, 904, 35, 46, 339, 157, 800, 296, 268, 248, 918, 169, 648, 140, 10, 933, 791, 964, 119, 761, 904, 805, 82, 580, 462, 361, 686, 655, 684, 797, 517, 178, 942, 700, 320, 997, 713, 424, 488, 135, 915, 263, 624, 464, 798, 296, 187, 132, 23, 464, 631, 834, 472, 831, 270, 569, 540, 385, 560, 416, 102, 369, 69, 307, 477, 692, 748, 67, 600, 322, 289, 327, 89, 193, 682, 385, 193, 197, 898, 355, 489, 750, 583, 937, 15, 518, 886, 499, 866, 768, 658, 318, 49, 846, 668, 26, 604, 627, 705, 819, 863, 272, 374, 394, 234, 62, 435, 916, 919, 58, 820, 418, 85, 776, 260, 872, 431, 232, 915, 68, 316, 199, 660, 280, 862, 986, 307, 331, 603, 223, 842, 154, 830, 383, 50, 65, 661, 0, 203, 770, 263, 855, 292, 75, 961, 307, 38, 404, 592, 129, 202, 836, 49, 730, 315, 236, 962, 290, 242, 992, 995, 65, 626, 242, 361, 776, 780, 221, 391, 542, 762, 432, 240, 221, 794, 480, 982, 151, 147, 564, 218, 486, 958, 816, 489, 404, 3, 544, 921, 516, 609, 520, 473, 776, 899, 523, 376, 827, 169, 979, 620, 877, 492, 585, 766, 356, 540, 193, 911, 941, 383, 519, 107, 403, 921, 104, 407, 697, 576, 548, 239, 84, 705, 22, 624, 1000, 551, 775, 760, 883, 299, 848, 981, 606, 387, 588, 476, 987, 389, 724, 691, 526, 767, 961, 764, 118, 476, 54, 13, 705, 929, 850, 455, 390, 968, 500, 783, 73, 856, 333, 622, 470, 274, 370, 896, 178, 433, 65, 864, 519, 857, 148, 737, 463, 727, 258, 481, 176, 850, 191, 995, 884, 167, 960, 279, 772, 518, 342, 69, 836, 625, 941, 427, 36, 719, 587, 526, 106, 161, 527, 787, 795, 860, 93, 121, 224, 733, 464, 503, 310, 876, 965, 846, 455, 72, 822, 893, 944, 485, 629, 215, 670, 973, 600, 744, 319, 659, 246, 420, 331, 945, 569, 662, 426, 511, 226, 253, 218, 487, 390, 756, 463, 881, 395, 346, 434, 314, 508, 357, 375, 787, 660, 456, 799, 510, 976, 628, 568, 389, 232, 849, 681, 107, 370, 167, 22, 576, 353, 583, 80, 106, 562, 732, 342, 886, 14, 67, 354, 52, 340, 757, 777, 896, 443, 689, 108, 643, 274, 341, 528, 356, 576, 680, 548, 218, 290, 168, 247, 332, 994, 501, 554, 561, 506, 491, 957, 764, 372, 470, 155, 743, 771, 395, 340, 487, 182, 306, 425, 902, 30, 874, 140, 865, 552, 182, 506, 388, 308, 182, 736, 500, 140, 280, 741, 935, 428, 269, 730, 31, 73, 937, 587, 104, 838, 46, 150, 652, 329, 415, 576, 969, 814, 17, 321, 878, 582, 652, 904, 440, 168, 221, 470, 626, 919, 306, 836, 74, 656, 488, 146, 292, 86, 636, 766, 191, 368, 171, 438, 438, 768, 2, 271, 298, 696, 98, 924, 908, 882, 797, 373, 526, 464, 401, 560, 244, 335, 91, 446, 835, 178, 57, 673, 212, 453, 140, 539, 654, 854, 51, 227, 699, 754, 130, 842, 582, 464, 987, 399, 512, 246, 967, 109, 179, 193, 583, 245, 317, 256, 224, 712, 754, 403, 192, 254, 343, 627, 551, 513, 744, 306, 958, 125, 631, 597, 545, 664, 800, 587, 817, 350, 482, 989, 912, 966, 18, 360, 393, 923, 903, 899, 164, 824, 251, 947, 178, 1000, 447, 414, 657, 645, 59, 844, 517, 261, 794, 242, 264, 292, 82, 987, 954, 45, 360, 946, 56, 44, 100, 497, 875, 848, 532, 559, 802, 738, 138, 138, 631, 289, 600, 298, 555, 660, 198, 496, 408, 695, 716, 838, 314, 566, 424, 765, 106, 670, 396, 363, 414, 984, 306, 713, 122, 224, 767, 502, 769, 850, 937, 183, 933, 223, 872, 434, 227, 65, 650, 510, 494, 832, 736, 727, 191, 270, 188, 866, 147, 416, 914, 409, 67, 104, 939, 275, 447, 56, 574, 453, 13, 283, 935, 531, 971, 823, 408, 118, 990, 767, 64, 143, 439, 939, 231, 634, 870, 769, 999, 739, 637, 530, 271, 48, 643, 741, 804, 960, 220, 60, 360, 233, 99, 705, 129, 15, 960, 380, 853, 950, 160, 664, 980, 768, 421, 785, 637, 339, 225, 792, 997, 901, 104, 976, 618, 723, 411, 503, 534, 221, 914, 619, 422, 154, 521, 111, 244, 930, 314, 24, 324, 807, 43, 128, 750, 799, 179, 930, 235, 897, 148, 3, 356, 585, 288, 500, 892, 524, 508, 855, 852, 661, 622, 690, 347, 829, 763, 559, 99, 504, 868, 376, 416, 517, 103, 778, 923, 929, 173, 295, 760, 483, 248, 337, 201, 651, 363, 353, 746, 98, 569, 612, 144, 819, 506, 588, 13, 44, 387, 567, 921, 372, 746, 422, 50, 371, 848, 261, 56, 830, 433, 322, 304, 811, 637, 546, 492, 330, 116, 822, 33, 16, 206, 499, 548, 481, 932, 177, 224, 640, 130, 319, 125, 954, 821, 641, 71, 224, 859, 60, 113, 587, 415, 458, 384, 195, 405, 56, 21, 872, 506, 823, 907, 771, 632, 727, 700, 511, 672, 346, 881, 165, 390, 664, 816, 652, 415, 401, 595, 52, 47, 981, 709, 573, 167, 977, 809, 244, 495, 705, 590, 354, 238, 384, 642, 357, 665, 184, 430, 817, 398, 735, 9, 73, 355, 522, 351, 156, 582, 295, 221, 168, 462, 417, 717, 726, 296, 433, 361, 633, 724, 951, 233, 976, 995, 995, 89, 187, 860, 804, 35, 263, 581, 364, 770, 534, 280, 714, 116, 591, 569, 804, 483, 902, 688, 405, 599, 942, 283, 540, 640, 168, 359, 92, 755, 421, 709, 775, 824, 440, 678, 826, 404, 937, 921, 735, 883, 279, 842, 557, 165, 24, 689, 888, 973, 147, 707, 887, 110, 485, 348, 197, 745, 359, 803, 558, 494, 238, 408, 898, 568, 362, 41, 511, 686, 597, 869, 679, 998, 85, 589, 64, 827, 698, 159, 216, 905, 141, 932, 262, 819, 422, 911, 245, 483, 462, 96, 217, 65, 580, 365, 10, 16, 376, 910, 930, 369, 458, 982, 935, 232, 844, 799, 823, 52, 471, 32, 286, 192, 265, 642, 626, 391, 539, 426, 76, 46, 769, 428, 362, 456, 897, 818, 517, 334, 642, 184, 819, 176, 703, 734, 254, 249, 428, 718, 31, 176, 247, 121, 617, 134, 237, 450, 497, 456, 949, 531, 980, 143, 422, 69, 328, 458, 436, 598, 199, 702, 461, 924, 548, 240, 862, 997, 703, 308, 796, 987, 631, 865, 583, 360, 196, 994, 316, 821, 896, 4, 436, 496, 796, 800, 567, 150, 174, 829, 308, 136, 254, 825, 188, 942, 973, 797, 308, 576, 794, 576, 776, 129, 986, 826, 640, 342, 691, 198, 329, 364, 346, 68, 203, 222, 881, 170, 440, 599, 187, 410, 454, 663, 283, 717, 395, 83, 226, 879, 814, 920, 531, 889, 926, 66, 443, 544, 836, 855, 981, 677, 848, 343, 29, 870, 209, 924, 62, 344, 709, 202, 291, 748, 355, 245, 145, 695, 655, 85, 990, 174, 776, 935, 538, 527, 172, 711, 503, 180, 252, 116, 476, 538, 484, 298, 492, 887, 149, 119, 771, 113, 779, 851, 708, 158, 341, 737, 899, 883, 867, 239, 358, 679, 434, 621, 956, 833, 780, 969, 788, 594, 358, 185, 336, 166, 815, 302, 548, 600, 115, 418, 143, 841, 589, 317, 56, 626, 461, 256, 754, 154, 577, 177, 541, 578, 311, 979, 559, 641, 274, 9, 898, 517, 298, 839, 70, 6, 591, 416, 262, 234, 416, 814, 85, 523, 680, 840, 681, 988, 28, 754, 681, 723, 676, 834, 601, 774, 313, 452, 118, 757, 527, 357, 366, 562, 305, 13, 326, 853, 895, 597, 816, 405, 928, 129, 829, 774, 644, 490, 139, 931, 100, 108, 171, 801, 415, 954, 79, 914, 485, 270, 615, 271, 896, 627, 359, 602, 840, 587, 658, 258, 241, 196, 790, 274, 741, 784, 131, 822, 646, 892, 146, 570, 794, 621, 480, 981, 737, 896, 967, 222, 273, 573, 645, 395, 247, 154, 846, 537, 702, 375, 316, 880, 173, 704, 404, 986, 902, 10, 635, 859, 861, 356, 755, 341, 516, 625, 966, 653, 900, 553, 686, 649, 929, 440, 681, 623, 218, 27, 552, 181, 734, 307, 265, 286, 658, 471, 561, 214, 464, 38, 63, 545, 190, 503, 703, 407, 41, 8, 45, 588, 825, 130, 170, 553, 188, 678, 41, 146, 346, 508, 157, 972, 914, 323, 368, 212, 867, 7, 24, 149, 886, 994, 258, 527, 49, 205, 755, 728, 311, 807, 741, 552, 631, 157, 819, 92, 83, 384, 134, 582, 676, 684, 762, 618, 56, 895, 461, 49, 134, 412, 821, 32, 178, 751, 289, 340, 600, 948, 523, 540, 143, 1000, 9, 798, 489, 419, 398, 704, 293, 179, 627, 165, 841, 615, 767, 575, 40, 667, 204, 191, 555, 616, 702, 552, 405, 45, 634, 566, 980, 606, 942, 18, 205, 995, 789, 738, 492, 445, 499, 380, 614, 241, 479, 893, 389, 848, 165, 612, 867, 819, 772, 145, 488, 398, 314, 966, 718, 647, 512, 215, 716, 837, 802, 928, 491, 204, 772, 6, 162, 698, 730, 199, 167, 303, 187, 982, 423, 956, 235, 41, 415, 613, 962, 754, 910, 967, 645, 705, 120, 137, 647, 569, 233, 209, 315, 954, 527, 70, 1, 300, 482, 514, 481, 336, 580, 87, 203, 921, 605, 471, 52, 48, 951, 820, 384, 282, 535, 330, 550, 419, 323, 700, 346, 479, 401, 315, 970, 556, 103, 371, 981, 604, 382, 221, 92, 823, 276, 579, 601, 165, 920, 21, 577, 125, 850, 439, 497, 34, 443, 29, 897, 448, 596, 351, 299, 757, 834, 183, 991, 241, 503, 960, 312, 3, 326, 67, 754, 487, 490, 648, 654, 999, 136, 210, 526, 333, 376, 113, 353, 269, 743, 104, 677, 356, 128, 605, 917, 416, 862, 0, 965, 980, 662, 917, 58, 348, 801, 219, 20, 871, 115, 908, 530, 36, 591, 660, 512, 455, 162, 752, 552, 854, 620, 197, 511, 843, 346, 774, 825, 916, 583, 203, 978, 659, 866, 252, 457, 97, 526, 689, 60, 307, 89, 259, 90, 920, 104, 80, 860]
        _Q, c = matrix.generate_QUBO_problem(S)
    
    string = " ---------- Problem start ----------\n"
    print(string)
    write(_DIR, string)
    
    if not QAP:
        string = "\n S = "+str(S)+"\n"
        print(string)
        write(_DIR, string)
    
    z = solver.solve(d_min = 70, eta = 0.01, i_max = 1000, k = 10, lambda_zero = 1, n = _n, N = 10, N_max = 100, p_delta = 0.1, q = 0.2, topology = 'pegasus', Q = _Q, DIR = _DIR, sim = True)
    
    min_z = solver.function_f(_Q,np.atleast_2d(z).T).item()
    
    string = "So far we found:\n- z - \n"+str(np.atleast_2d(z).T)+"\nand has minimum = "+str(min_z)+"\n"
    if not QAP:
        diff2 = (c**2 + 4*min_z)

        try:
            string += "c = "+str(c)+", c^2 = "+str(c**2)+", diff^2 = "+str(diff2)+", diff = "+str(np.sqrt(diff2))+"\n"
            print(string)
            write(_DIR, string)
        except:
            string += "c = "+str(c)+", c^2 = "+str(c**2)+", diff^2 = "+str(diff2)+"\n"
            print(string)
            write(_DIR, string)
    else:
        string += "y = "+str(y)+", penalty = "+str(penalty)+", difference (y+minimum) = "+str(y+min_z)+"\n"
        print(string)
        write(_DIR, string)


if __name__ == '__main__':
    try:
        n = int(sys.argv[1])
    except:
        n = 0
    main(n)